{"version":3,"sources":["../../src/routes/users.ts"],"names":["router","registry","openapi","path","responses","z","array","User","ErrorResponse","get","req","res","json","request","params","object","userId","string","description","ValidationError","user","status","message","body","name","post","sendStatus"],"mappings":";;;;;;;AAAA;;AAEA;;AAMA;;AACA;;AACA;;AAEA,IAAMA,MAAM,GAAG,sCAAcC,kBAAd,CAAf;AAEAD,MAAM,CACHE,OADH,CACW;AACPC,EAAAA,IAAI,EAAE,QADC;AAEPC,EAAAA,SAAS,EAAE;AACT,SAAKC,OAAEC,KAAF,CAAQC,WAAR,CADI;AAET,SAAKC;AAFI;AAFJ,CADX,EAQGC,GARH,CAQO,EARP,EAQW,UAACC,GAAD,EAAMC,GAAN,EAAc;AACrBA,EAAAA,GAAG,CAACC,IAAJ,CAAS,uBAAT;AACD,CAVH;AAYAZ,MAAM,CACHE,OADH,CACW;AACPC,EAAAA,IAAI,EAAE,iBADC;AAEPU,EAAAA,OAAO,EAAE;AACPC,IAAAA,MAAM,EAAET,OAAEU,MAAF,CAAS;AACfC,MAAAA,MAAM,EAAEX,OAAEY,MAAF,GAAWf,OAAX,CAAmB;AAAEgB,QAAAA,WAAW,EAAE;AAAf,OAAnB;AADO,KAAT;AADD,GAFF;AAOPd,EAAAA,SAAS,EAAE;AACT,SAAKG,WADI;AAET,SAAKY,sBAFI;AAGT,SAAKX,oBAHI;AAIT,SAAKA;AAJI;AAPJ,CADX,EAeGC,GAfH,CAeO,EAfP,EAeW,UAACC,GAAD,EAAMC,GAAN,EAAc;AACrB,MAAMS,IAAI,GAAG,oBAAQV,GAAG,CAACI,MAAJ,CAAWE,MAAnB,CAAb;;AAEA,MAAI,CAACI,IAAL,EAAW;AACTT,IAAAA,GAAG,CACAU,MADH,CACU,GADV,EAEGT,IAFH,CAEQ;AAAEU,MAAAA,OAAO,EAAE;AAAX,KAFR;AAGD;;AAEDX,EAAAA,GAAG,CAACC,IAAJ,CAASQ,IAAT;AACD,CAzBH;AA2BApB,MAAM,CACHE,OADH,CACW;AACPC,EAAAA,IAAI,EAAE,QADC;AAEPU,EAAAA,OAAO,EAAE;AACPU,IAAAA,IAAI,EAAElB,OAAEU,MAAF,CAAS;AACbS,MAAAA,IAAI,EAAEnB,OAAEY,MAAF;AADO,KAAT;AADC,GAFF;AAOPb,EAAAA,SAAS,EAAE;AACT,SAAKG,WADI;AAET,SAAKY,sBAFI;AAGT,SAAKX;AAHI;AAPJ,CADX,EAcGiB,IAdH,CAcQ,EAdR,EAcY,UAACf,GAAD,EAAMC,GAAN,EAAc;AACtBA,EAAAA,GAAG,CAACC,IAAJ,CAAS,uBAAWF,GAAG,CAACa,IAAf,CAAT;AACD,CAhBH;AAkBAvB,MAAM,CACHE,OADH,CACW;AACPC,EAAAA,IAAI,EAAE,iBADC;AAEPU,EAAAA,OAAO,EAAE;AACPC,IAAAA,MAAM,EAAET,OAAEU,MAAF,CAAS;AACfC,MAAAA,MAAM,EAAEX,OAAEY,MAAF,GAAWf,OAAX,CAAmB;AAAEgB,QAAAA,WAAW,EAAE;AAAf,OAAnB;AADO,KAAT;AADD,GAFF;AAOPd,EAAAA,SAAS,EAAE;AACT,SAAK,IADI;AAET,SAAKe,sBAFI;AAGT,SAAKX;AAHI;AAPJ,CADX,YAcU,UAdV,EAcsB,UAACE,GAAD,EAAMC,GAAN,EAAc;AAChC,yBAAWD,GAAG,CAACI,MAAJ,CAAWE,MAAtB;AACAL,EAAAA,GAAG,CAACe,UAAJ,CAAe,GAAf;AACD,CAjBH;eAmBe1B,MAAM,CAACA,M","sourcesContent":["import { OpenAPIRouter } from \"express-openapi-zod\";\r\n\r\nimport {\r\n  createUser,\r\n  getUser,\r\n  listUsers,\r\n  removeUser\r\n} from \"../controllers/users\";\r\nimport { ErrorResponse, User, ValidationError } from \"../model\";\r\nimport { registry } from \"../registry\";\r\nimport { z } from \"../zod\";\r\n\r\nconst router = OpenAPIRouter(registry);\r\n\r\nrouter\r\n  .openapi({\r\n    path: \"/users\",\r\n    responses: {\r\n      200: z.array(User),\r\n      500: ErrorResponse\r\n    }\r\n  })\r\n  .get(\"\", (req, res) => {\r\n    res.json(listUsers());\r\n  });\r\n\r\nrouter\r\n  .openapi({\r\n    path: \"/users/{userId}\",\r\n    request: {\r\n      params: z.object({\r\n        userId: z.string().openapi({ description: \"Identity of user\" })\r\n      })\r\n    },\r\n    responses: {\r\n      200: User,\r\n      400: ValidationError,\r\n      404: ErrorResponse,\r\n      500: ErrorResponse\r\n    }\r\n  })\r\n  .get(\"\", (req, res) => {\r\n    const user = getUser(req.params.userId);\r\n\r\n    if (!user) {\r\n      res\r\n        .status(404)\r\n        .json({ message: \"We couldn't find the user you were looking for!\" });\r\n    }\r\n\r\n    res.json(user);\r\n  });\r\n\r\nrouter\r\n  .openapi({\r\n    path: \"/users\",\r\n    request: {\r\n      body: z.object({\r\n        name: z.string()\r\n      })\r\n    },\r\n    responses: {\r\n      200: User,\r\n      400: ValidationError,\r\n      500: ErrorResponse\r\n    }\r\n  })\r\n  .post(\"\", (req, res) => {\r\n    res.json(createUser(req.body));\r\n  });\r\n\r\nrouter\r\n  .openapi({\r\n    path: \"/users/{userId}\",\r\n    request: {\r\n      params: z.object({\r\n        userId: z.string().openapi({ description: \"Identity of user\" })\r\n      })\r\n    },\r\n    responses: {\r\n      200: null,\r\n      400: ValidationError,\r\n      500: ErrorResponse\r\n    }\r\n  })\r\n  .delete(\"/:userId\", (req, res) => {\r\n    removeUser(req.params.userId);\r\n    res.sendStatus(200);\r\n  });\r\n\r\nexport default router.router;\r\n"],"file":"users.js"}